{"version":3,"file":"page-2.js","sources":["../src/js/afisha.js"],"sourcesContent":["import axios from 'axios';\n\nconst BASE_URL = 'https://api.themoviedb.org/3';\nconst ENDPOINT = '/trending/movie/week';\n\n\n// const container = document.querySelector('.js-movie-list');\n// const loadMore = document.querySelector('.js-load-more');\n//\n// loadMore.addEventListener('click', onLoadMore);\n//\n// let page = 1;\n//\n// async function serviceMovie(page=1){\n//   const response = await axios(`${BASE_URL}${ENDPOINT}`, {\n//     params: {\n//       api_key: import.meta.env.VITE_API_KEY,\n//       page\n//     }\n//   });\n//   return response.data;\n//\n// }\n//\n// serviceMovie(page)\n//   .then(data => {\n//     console.log(data);\n//     container.insertAdjacentHTML('beforeend', createMarkup(data.results));\n//     if(data.page < data.total_pages){\n//     loadMore.classList.replace(\"load-more-hidden\", \"load-more\");}\n//   })\n// .catch(error => {\n// });\n//\n//\n// function createMarkup(arr){\n//   return arr.map(({original_title, vote_average, poster_path, release_date}) => `\n// <li class=\"movie-card\">\n//   <img src=\"https://image.tmdb.org/t/p/w500${poster_path}\" alt=\"${original_title}\"/>\n//   <div class=\"movie-info\">\n//   <h2>${original_title}</h2>\n//   <p>Дата релиза: ${release_date}</p>\n//   <p>Рейтинг: ${vote_average}</p>\n// </div>\n// </li>\n//   `).join(\"\");\n// };\n//\n// async function onLoadMore(){\n//   page++;\n//   loadMore.disabled = true;\n//   loadMore.textContent = \"Loading...\";\n//   try{\n//     const data = await serviceMovie(page);\n//     container.insertAdjacentHTML('beforeend', createMarkup(data.results));\n//     if(data.page >= data.total_pages){\n//       loadMore.classList.replace(\"load-more\", \"load-more-hidden\", );\n//           }\n//     const card = document.querySelector(\".movie-card\");\n//     console.log(card);\n//     const cardHeight = card.getBoundingClientRect().height;\n//     window.scrollBy({\n//       left: 0,\n//       top: cardHeight,\n//       behavior: \"smooth\"\n//     })\n//   }\n//   catch(error){\n//     console.log(error.message);\n//   }\n//   finally{\n//     loadMore.disabled = false;\n//     loadMore.textContent = \"Load More\";\n//   }\n// };\n\n\nconst container = document.querySelector('.js-movie-list');\nconst guard = document.querySelector('.js-guard');\nconst options = {\n  root: null,\n  rootMargin: \"1500px\",\n  threshold: 0,\n};\n\nconst observer = new IntersectionObserver(handlePagination, options);\nlet page = 1\n\nasync function serviceMovie(page=1){\n  const response = await axios(`${BASE_URL}${ENDPOINT}`, {\n    params: {\n      api_key: import.meta.env.VITE_API_KEY,\n      page\n    }\n  });\n  return response.data;\n\n}\nfunction createMarkup(arr){\n  return arr.map(({original_title, vote_average, poster_path, release_date}) => `\n<li class=\"movie-card\">\n  <img src=\"https://image.tmdb.org/t/p/w500${poster_path}\" alt=\"${original_title}\"/>\n  <div class=\"movie-info\">\n  <h2>${original_title}</h2>\n  <p>Дата релиза: ${release_date}</p>\n  <p>Рейтинг: ${vote_average}</p>\n</div>\n</li>\n  `).join(\"\");\n};\n\nserviceMovie(page)\n.then(data => {\n  container.insertAdjacentHTML('beforeend', createMarkup(data.results));\n  observer.observe(guard);\n})\n.catch(error => {\n  console.log(error.message);\n})\nfunction handlePagination(entries, observer){\n  entries.forEach(async (entry) => {\n    if (entry.isIntersecting) {\n      page++;\n      try{\n        const data = await serviceMovie(page);\n        container.insertAdjacentHTML('beforeend', createMarkup(data.results));\n      }\n      catch(error){\n        console.log(error.message);\n      }\n    }\n  })\n}"],"names":["BASE_URL","ENDPOINT","container","guard","options","observer","handlePagination","page","serviceMovie","axios","createMarkup","arr","original_title","vote_average","poster_path","release_date","data","error","entries","entry"],"mappings":"sHAEA,MAAMA,EAAW,+BACXC,EAAW,uBA0EXC,EAAY,SAAS,cAAc,gBAAgB,EACnDC,EAAQ,SAAS,cAAc,WAAW,EAC1CC,EAAU,CACd,KAAM,KACN,WAAY,SACZ,UAAW,CACb,EAEMC,EAAW,IAAI,qBAAqBC,EAAkBF,CAAO,EACnE,IAAIG,EAAO,EAEX,eAAeC,EAAaD,EAAK,EAAE,CAOjC,OANiB,MAAME,EAAM,GAAGT,CAAQ,GAAGC,CAAQ,GAAI,CACrD,OAAQ,CACN,QAAS,mCACT,KAAAM,CACF,CAAA,CACD,GACe,IAElB,CACA,SAASG,EAAaC,EAAI,CACjB,OAAAA,EAAI,IAAI,CAAC,CAAC,eAAAC,EAAgB,aAAAC,EAAc,YAAAC,EAAa,aAAAC,KAAkB;AAAA;AAAA,6CAEnCD,CAAW,UAAUF,CAAc;AAAA;AAAA,QAExEA,CAAc;AAAA,oBACFG,CAAY;AAAA,gBAChBF,CAAY;AAAA;AAAA;AAAA,GAGzB,EAAE,KAAK,EAAE,CACZ,CAEAL,EAAaD,CAAI,EAChB,KAAaS,GAAA,CACZd,EAAU,mBAAmB,YAAaQ,EAAaM,EAAK,OAAO,CAAC,EACpEX,EAAS,QAAQF,CAAK,CACxB,CAAC,EACA,MAAec,GAAA,CACN,QAAA,IAAIA,EAAM,OAAO,CAC3B,CAAC,EACD,SAASX,EAAiBY,EAASb,EAAS,CAClCa,EAAA,QAAQ,MAAOC,GAAU,CAC/B,GAAIA,EAAM,eAAgB,CACxBZ,IACG,GAAA,CACK,MAAAS,EAAO,MAAMR,EAAaD,CAAI,EACpCL,EAAU,mBAAmB,YAAaQ,EAAaM,EAAK,OAAO,CAAC,QAEhEC,EAAM,CACF,QAAA,IAAIA,EAAM,OAAO,CAC3B,CACF,CAAA,CACD,CACH"}